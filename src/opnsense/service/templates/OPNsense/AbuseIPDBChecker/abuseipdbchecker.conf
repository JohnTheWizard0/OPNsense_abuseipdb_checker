{% if not helpers.empty('OPNsense.abuseipdbchecker.general.Enabled') %}
[general]
LogFile={{ OPNsense.abuseipdbchecker.general.LogFile|default("/var/log/filter/latest.log") }}
CheckFrequency={{ OPNsense.abuseipdbchecker.general.CheckFrequency|default("7") }}
SuspiciousThreshold={{ OPNsense.abuseipdbchecker.general.SuspiciousThreshold|default("40") }}
MaliciousThreshold={{ OPNsense.abuseipdbchecker.general.MaliciousThreshold|default("70") }}
IgnoreBlockedConnections={{ OPNsense.abuseipdbchecker.general.IgnoreBlockedConnections|default("1") }}
ApiKey={{ OPNsense.abuseipdbchecker.general.ApiKey|default("") }}
ApiSecret={{ OPNsense.abuseipdbchecker.general.ApiSecret|default("") }}

[network]
LanSubnets={{ OPNsense.abuseipdbchecker.network.LanSubnets|default("192.168.0.0/16,10.0.0.0/8,172.16.0.0/12") }}
IgnoreProtocols={{ OPNsense.abuseipdbchecker.network.IgnoreProtocols|default("icmp,igmp") }}

[api]
Key={{ OPNsense.abuseipdbchecker.api.Key }}
Endpoint={{ OPNsense.abuseipdbchecker.api.Endpoint|default("https://api.abuseipdb.com/api/v2/check") }}
MaxAge={{ OPNsense.abuseipdbchecker.api.MaxAge|default("90") }}
DailyCheckLimit={{ OPNsense.abuseipdbchecker.api.DailyCheckLimit|default("1000") }}

[alias]
Enabled={{ OPNsense.abuseipdbchecker.alias.Enabled|default("1") }}
IncludeSuspicious={{ OPNsense.abuseipdbchecker.alias.IncludeSuspicious|default("0") }}
MaxRecentHosts={{ OPNsense.abuseipdbchecker.alias.MaxRecentHosts|default("500") }}
{% endif %}