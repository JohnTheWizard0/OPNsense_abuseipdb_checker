{% if helpers.exists('OPNsense.abuseipdbchecker.general.enabled') and OPNsense.abuseipdbchecker.general.enabled == '1' %}
[General]
LogFile={{ OPNsense.abuseipdbchecker.general.logFile|default('/var/log/filter.log') }}
CheckFrequency={{ OPNsense.abuseipdbchecker.general.checkFrequency|default('7') }}
AbuseScoreThreshold={{ OPNsense.abuseipdbchecker.general.abuseScoreThreshold|default('80') }}
DailyCheckLimit={{ OPNsense.abuseipdbchecker.general.dailyCheckLimit|default('100') }}
IgnoreBlockedConnections={% if OPNsense.abuseipdbchecker.general.ignoreBlockedConnections == '1' %}true{% else %}false{% endif %}

[NetworkSettings]
LANSubnets={{ OPNsense.abuseipdbchecker.network.lanSubnets|default('192.168.0.0/16,10.0.0.0/8,172.16.0.0/12') }}
IgnoreProtocols={{ OPNsense.abuseipdbchecker.network.ignoreProtocols|default('icmp,igmp') }}

[AbuseIPDB]
APIKey={{ OPNsense.abuseipdbchecker.api.key|default('YOUR_API_KEY') }}
APIEndpoint={{ OPNsense.abuseipdbchecker.api.endpoint|default('https://www.abuseipdb.com/check') }}
MaxAge={{ OPNsense.abuseipdbchecker.api.maxAge|default('90') }}

[Email]
Enabled={% if OPNsense.abuseipdbchecker.email.enabled == '1' %}true{% else %}false{% endif %}
SMTPServer={{ OPNsense.abuseipdbchecker.email.smtpServer|default('smtp.example.com') }}
SMTPPort={{ OPNsense.abuseipdbchecker.email.smtpPort|default('587') }}
SMTPUsername={{ OPNsense.abuseipdbchecker.email.smtpUsername|default('') }}
SMTPPassword={{ OPNsense.abuseipdbchecker.email.smtpPassword|default('') }}
FromAddress={{ OPNsense.abuseipdbchecker.email.fromAddress|default('firewall@yourdomain.com') }}
ToAddress={{ OPNsense.abuseipdbchecker.email.toAddress|default('admin@yourdomain.com') }}
UseTLS={% if OPNsense.abuseipdbchecker.email.useTLS == '1' %}true{% else %}false{% endif %}
{% endif %}