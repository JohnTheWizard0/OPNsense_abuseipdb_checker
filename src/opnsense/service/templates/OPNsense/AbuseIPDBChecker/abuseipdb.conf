{% if not helpers.empty('OPNsense.abuseipdbchecker.general.enabled') %}
[General]
LogFile={{ OPNsense.abuseipdbchecker.general.logFile|default("/var/log/filter.log") }}
CheckFrequency={{ OPNsense.abuseipdbchecker.general.checkFrequency|default("7") }}
AbuseScoreThreshold={{ OPNsense.abuseipdbchecker.general.abuseScoreThreshold|default("80") }}
DailyCheckLimit={{ OPNsense.abuseipdbchecker.general.dailyCheckLimit|default("100") }}
IgnoreBlockedConnections={{ OPNsense.abuseipdbchecker.general.ignoreBlockedConnections|default("1") == "1" ? "true" : "false" }}

[NetworkSettings]
LANSubnets={{ OPNsense.abuseipdbchecker.network.lanSubnets|default("192.168.0.0/16,10.0.0.0/8,172.16.0.0/12") }}
IgnoreProtocols={{ OPNsense.abuseipdbchecker.network.ignoreProtocols|default("icmp,igmp") }}

[AbuseIPDB]
APIKey={{ OPNsense.abuseipdbchecker.api.key|default("YOUR_API_KEY") }}
APIEndpoint={{ OPNsense.abuseipdbchecker.api.endpoint|default("https://www.abuseipdb.com/check") }}
MaxAge={{ OPNsense.abuseipdbchecker.api.maxAge|default("90") }}

[Email]
Enabled={{ OPNsense.abuseipdbchecker.email.enabled|default("1") == "1" ? "true" : "false" }}
SMTPServer={{ OPNsense.abuseipdbchecker.email.smtpServer|default("") }}
SMTPPort={{ OPNsense.abuseipdbchecker.email.smtpPort|default("587") }}
SMTPUsername={{ OPNsense.abuseipdbchecker.email.smtpUsername|default("") }}
SMTPPassword={{ OPNsense.abuseipdbchecker.email.smtpPassword|default("") }}
FromAddress={{ OPNsense.abuseipdbchecker.email.fromAddress|default("") }}
ToAddress={{ OPNsense.abuseipdbchecker.email.toAddress|default("") }}
UseTLS={{ OPNsense.abuseipdbchecker.email.useTLS|default("1") == "1" ? "true" : "false" }}
{% endif %}